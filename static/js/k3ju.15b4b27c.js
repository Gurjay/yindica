(window.webpackJsonp=window.webpackJsonp||[]).push([["k3ju"],{k3ju:function(e,t,i){"use strict";i.r(t),t.default={props:{categories:{type:Array}},model:{event:["reloadTree","current","statusChange"]},data:function(){return{editable:!1,showAdd:!1,temp_name:"",temp_label:"",temp_selectable:!0,current:null,defaultProps:{children:"children",label:"label"},openFold:!0,menuTree:[{label:"首页",system:!0,id:1,children:[{label:"总览",system:!0,id:2},{id:3,label:"设置",children:[{label:"面板库",id:4},{id:5,label:"视图"}]}]},{label:"客服中心",system:!0,id:7,children:[{label:"总览",system:!0,id:8},{id:9,label:"客服坐席"},{id:10,label:"服务工单"},{id:11,label:"信息发布"},{id:111,label:"客服协同"}]},{id:12,label:"运维中心",system:!0,children:[{label:"总览",system:!0,id:13},{id:14,label:"请求"},{id:15,label:"故障"}]},{id:16,label:"监控中心",children:[{id:17,label:"总览"},{id:18,label:"拓扑图"}]},{id:19,label:"操作中心",children:[{id:20,label:"总览"}]},{id:21,label:"开发设置",children:[{id:22,label:"总览"}]},{id:23,label:"知识库",children:[{id:24,label:"总览"}]},{id:26,label:"设置",children:[{id:27,label:"初始化"}]},{id:28,label:"运营分析",children:[]},{id:29,label:"资源中心",children:[]},{id:30,label:"配置中心",children:[]},{id:31,label:"系统设置",children:[]}],rules:{name:[{trigger:"blur",required:!0}],label:[{trigger:"blur",required:!0}]}}},mounted:function(){this.onItemClick(this.menuTree[0])},methods:{editMenu:function(){this.editable=!0},saveMenu:function(){this.findResult(this.categories,[],[],[],null)},cancelSave:function(){var e=this;this.$confirm("是否取消?","提示",{customClass:"its_message_box",cancelButtonClass:"el-button--mini",confirmButtonClass:"el-button--mini",cancelButtonText:"取 消",confirmButtonText:"确 定",type:"warning"}).then(function(){e.editable=!1,e.$emit("reloadTree")}).catch(function(){})},addClick:function(e,t){this.onItemClick(t),this.showAdd=!0},deleteClick:function(e,t){var i=this;this.onItemClick(t),null!=this.current&&0==this.current.system?this.$confirm("是否要删除此节点?","提示",{customClass:"its_message_box",cancelButtonClass:"el-button--mini",confirmButtonClass:"el-button--mini",cancelButtonText:"取 消",confirmButtonText:"确 定",type:"warning"}).then(function(){if(null==t.id){var n=e.parent,l=n.data.children;n.childNodes;if(null!=n){var a=l.findIndex(function(e){return e.name===t.name});a>0&&l.splice(a,1)}}else t.deleted=!0;i.resetTree()}).catch(function(){i.$message({type:"info",message:"已取消删除"})}):this.$message({type:"info",message:"不可删除系统菜单"})},moveUp:function(e,t){this.onItemClick(t);var i=void 0,n=void 0;if(e.level>1){var l=e.parent;i=l.data.children,n=l.childNodes}else{var a=e.parent;i=this.categories,n=a.childNodes}var s=i.findIndex(function(e){return e.name===t.name});if(s>0){var d=i[s],r=i[s-1];this.$set(i,s-1,d),this.$set(i,s,r);var c=n[s-1],h=n[s];this.$set(n,s-1,h),this.$set(n,s,c),this.addUpdate(t),this.addUpdate(r),this.resetTree()}},moveDown:function(e,t){this.onItemClick(t);var i=void 0,n=void 0;if(e.level>1){var l=e.parent;i=l.data.children,n=l.childNodes}else{var a=e.parent;i=this.categories,n=a.childNodes}var s=i.findIndex(function(e){return e.name===t.name});if(s<i.length){var d=i[s],r=i[s+1];this.$set(i,s+1,d),this.$set(i,s,r);var c=n[s+1],h=n[s];this.$set(n,s+1,h),this.$set(n,s,c),this.addUpdate(t),this.addUpdate(r),this.resetTree()}},moveLeft:function(e,t){this.onItemClick(t);var i=void 0,n=void 0;i=e.parent.data.children,n=e.parent.parent.data.children;var l=i.findIndex(function(e){return e.name===t.name}),a=i[l];i.splice(l,1),n.push(a),this.addUpdate(t),this.resetTree()},moveRight:function(e,t){this.onItemClick(t);var i=e.parent.data.children,n=i.findIndex(function(e){return e.name===t.name});if(n>0){var l=i[n],a=i[n-1].children;i.splice(n,1),a.push(l),this.addUpdate(t),this.resetTree()}},onItemClick:function(e){this.current!=e&&(this.current=e,this.$emit("current",this.current)),1==this.editable&&(this.addUpdate(e),this.resetTree())},onAddConfirm:function(){var e={name:this.temp_name,label:this.temp_label,type:"url",selectable:this.temp_selectable,description:"",icon:"",parent:this.current.name,system:!1,url:"",module:""};this.current.children.push(e),this.closeAdd()},closeAdd:function(){this.temp_name="",this.temp_label="",this.temp_selectable=!0,this.showAdd=!1},addUpdate:function(e){null!=e.id&&1==this.editable&&(e.updated=!0)},findResult:function(e,t,i,n,l){for(var a=0;a<e.length;a++){var s=e[a];null==s.id?t.push(s):1==s.deleted?n.push(s.name):1!=s.updated&&s.position==a||(s.position=a,null!=l&&(s.parent=l),i.push(s)),null!=s.children&&s.children.length>0&&this.findResult(s.children,t,i,n,s.name)}},resetTree:function(){this.editable=!1,this.editable=!0}},watch:{editable:function(e){1==e&&null!=this.current&&(this.current.updated=!0),this.$emit("statusChange",e)}}}}}]);